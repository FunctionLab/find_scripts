<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T4U3">Chrom_maxima</span>, <span class="var type1" id="S3T17U4">Maximas</span>,<span class="var type1" id="S4T23U5">Mcount</span>,<span class="var type1" id="S5T23U6">Mpot</span> <span class="var type1" id="S6T1U7">nMaxima</span>]=<span class="message warning" id="M1F1C">genomeWalkerFunc</span>(<span class="var type1" id="S7T24U10">chrom_data</span>, <span class="var type1" id="S8T5U11">nodePot</span>,<span class="var type1" id="S9T6U12">edgePot</span>,<span class="var type1" id="S10T7U13">edgeEnds</span>, <span class="var type1" id="S11T1U14">nNodes</span>, <span class="var type1" id="S12T1U15">maxRounds</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2"> 2</a></span><span class="line"><span class="mxinfo" id="T1:U12"><span class="var type1" id="S6T1U18">nMaxima</span>=<span class="mxinfo" id="T1:U14">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3"> 3</a></span><span class="line"><span class="mxinfo" id="T17:U15"><span class="var type1" id="S3T17U22">Maximas</span>=<span class="mxinfo" id="T17:U17"><span class="mxinfo" id="T17:U18">zeros(20000,<span class="var type1" id="S11T1U27">nNodes</span>)</span>-<span class="mxinfo" id="T1:U20">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4"> 4</a></span><span class="line"><span class="mxinfo" id="T23:U21"><span class="var type1" id="S4T23U31">Mcount</span>=<span class="mxinfo" id="T23:U23">zeros(20000,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5"> 5</a></span><span class="line"><span class="mxinfo" id="T23:U24"><span class="var type1" id="S5T23U38">Mpot</span>=<span class="mxinfo" id="T23:U26">zeros(20000,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6"> 6</a></span><span class="line"><span class="mxinfo" id="T4:U27"><span class="var type1" id="S2T4U45">Chrom_maxima</span>=<span class="mxinfo" id="T4:U29">zeros(1, <span class="mxinfo" id="T1:U30">length(<span class="mxinfo" id="T3:U31"><span class="var type1" id="S7T24U52">chrom_data</span>(<span class="mxinfo" id="T25:U33">:</span>,<span class="mxinfo" id="T1:U34">1</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7"> 7</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S15T1U57">t</span>= <span class="mxinfo" id="T1:U36">1</span>: <span class="var type1" id="S12T1U60">maxRounds</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,9"> 9</a></span><span class="line">    <span class="mxinfo" id="T4:U38"><span class="var type1" id="S16T4U63">y</span> = <span class="mxinfo" id="T4:U40">ones(1,<span class="var type1" id="S11T1U67">nNodes</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10">10</a></span><span class="line">    <span class="mxinfo" id="T4:U42"><span class="var type1" id="S18T4U70">y_new</span> = <span class="mxinfo" id="T4:U44"><span class="mxinfo" id="T18:U45"><span class="var type1" id="S7T24U73">chrom_data</span>(<span class="var type1" id="S15T1U74">t</span>,<span class="mxinfo" id="T25:U48">:</span>)</span>+<span class="mxinfo" id="T1:U49">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11">11</a></span><span class="line">    <span class="keyword">while</span> ( 1 )</span></span>
<span class="srcline"><span class="lineno"><a href="1,12">12</a></span><span class="line">        <span class="comment">%Try all neighbours (move one step)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13">13</a></span><span class="line">        <span class="mxinfo" id="T4:U50"><span class="var type1" id="S16T4U82">y</span>=<span class="var type1" id="S18T4U83">y_new</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14">14</a></span><span class="line">        <span class="mxinfo" id="T4:U53"><span class="var type1" id="S19T4U86">potNei</span> = <span class="mxinfo" id="T4:U55">ones(1,<span class="mxinfo" id="T1:U56"><span class="var type1" id="S11T1U91">nNodes</span>+<span class="mxinfo" id="T1:U58">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15">15</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S20T1U95">i</span> = <span class="mxinfo" id="T1:U60">1</span>:<span class="var type1" id="S11T1U98">nNodes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16">16</a></span><span class="line">            <span class="mxinfo" id="T4:U62"><span class="var type1" id="S21T4U101">ynei</span> = <span class="var type1" id="S16T4U102">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17">17</a></span><span class="line">            <span class="mxinfo" id="T1:U65"><span class="mxinfo" id="T1:U66"><span class="var type1" id="S21T4U106">ynei</span>(<span class="var type1" id="S20T1U107">i</span>)</span>= <span class="mxinfo" id="T1:U69"><span class="fcn" id="F3N4:B109">swap</span>(<span class="mxinfo" id="T1:U70"><span class="var type1" id="S16T4U111">y</span>(<span class="var type1" id="S20T1U112">i</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18">18</a></span><span class="line">            <span class="mxinfo" id="T1:U73"><span class="mxinfo" id="T1:U74"><span class="var type1" id="S19T4U116">potNei</span>(<span class="var type1" id="S20T1U117">i</span>)</span> = <span class="mxinfo" id="T1:U77"><span class="fcn" id="F6N2:B119">UGM_ConfigurationPotential</span>(<span class="var type1" id="S21T4U120">ynei</span>,<span class="var type1" id="S8T5U121">nodePot</span>,<span class="var type1" id="S9T6U122">edgePot</span>,<span class="var type1" id="S10T7U123">edgeEnds</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19">19</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20">20</a></span><span class="line">        <span class="mxinfo" id="T1:U82"><span class="mxinfo" id="T1:U83"><span class="var type1" id="S19T4U127">potNei</span>(<span class="mxinfo" id="T1:U85"><span class="var type1" id="S11T1U129">nNodes</span>+<span class="mxinfo" id="T1:U87">1</span></span>)</span>= <span class="mxinfo" id="T1:U88"><span class="fcn" id="F6N2:B132">UGM_ConfigurationPotential</span>(<span class="var type1" id="S16T4U133">y</span>,<span class="var type1" id="S8T5U134">nodePot</span>,<span class="var type1" id="S9T6U135">edgePot</span>,<span class="var type1" id="S10T7U136">edgeEnds</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21">21</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,22">22</a></span><span class="line">        <span class="mxinfo" id="T1:U93">[<span class="var type1" id="S24T1U140">junk</span> <span class="var type1" id="S20T1U141">i</span>]= max(<span class="var type1" id="S19T4U144">potNei</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23">23</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,24">24</a></span><span class="line">        <span class="keyword">if</span>(<span class="mxinfo" id="T14:U97"><span class="var type1" id="S20T1U149">i</span>==<span class="mxinfo" id="T1:U99"><span class="var type1" id="S11T1U151">nNodes</span>+<span class="mxinfo" id="T1:U101">1</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,25">25</a></span><span class="line">            <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26">26</a></span><span class="line">        <span class="keyword">end</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27">27</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,28">28</a></span><span class="line">        <span class="mxinfo" id="T4:U102"><span class="var type1" id="S18T4U156">y_new</span>=<span class="var type1" id="S16T4U157">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29">29</a></span><span class="line">        <span class="mxinfo" id="T1:U105"><span class="mxinfo" id="T1:U106"><span class="var type1" id="S18T4U161">y_new</span>(<span class="var type1" id="S20T1U162">i</span>)</span>= <span class="mxinfo" id="T1:U109"><span class="fcn" id="F3N4:B164">swap</span>(<span class="mxinfo" id="T1:U110"><span class="var type1" id="S16T4U166">y</span>(<span class="var type1" id="S20T1U167">i</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30">30</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31">31</a></span><span class="line">    <span class="keyword">if</span>( <span class="mxinfo" id="T14:U113"><span class="var type1" id="S6T1U172">nMaxima</span>~=<span class="mxinfo" id="T1:U115">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,32">32</a></span><span class="line">        <span class="mxinfo" id="T1:U116"><span class="var type1" id="S20T1U176">i</span>=<span class="mxinfo" id="T1:U118">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33">33</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S26T1U180">j</span>=<span class="mxinfo" id="T1:U120">1</span>:<span class="var type1" id="S6T1U183">nMaxima</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34">34</a></span><span class="line">            <span class="keyword">if</span>( <span class="mxinfo" id="T14:U122"><span class="mxinfo" id="T1:U123">sum( <span class="mxinfo" id="T18:U124">(<span class="mxinfo" id="T4:U125"><span class="var type1" id="S18T4U193">y_new</span>-<span class="mxinfo" id="T1:U127">1</span></span>)==<span class="mxinfo" id="T4:U128"><span class="var type1" id="S3T17U196">Maximas</span>(<span class="var type1" id="S26T1U197">j</span>,<span class="mxinfo" id="T25:U131">:</span>)</span></span> )</span> == <span class="mxinfo" id="T1:U132">length(<span class="var type1" id="S18T4U201">y_new</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,35">35</a></span><span class="line">                <span class="mxinfo" id="T1:U134"><span class="var type1" id="S20T1U204">i</span>=<span class="var type1" id="S26T1U205">j</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36">36</a></span><span class="line">                <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37">37</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38">38</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39">39</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,40">40</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T14:U137"><span class="var type1" id="S20T1U211">i</span>==<span class="mxinfo" id="T1:U139">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,41">41</a></span><span class="line">            <span class="mxinfo" id="T1:U140"><span class="var type1" id="S6T1U215">nMaxima</span>=<span class="mxinfo" id="T1:U142"><span class="var type1" id="S6T1U217">nMaxima</span>+<span class="mxinfo" id="T1:U144">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42">42</a></span><span class="line">            <span class="mxinfo" id="T4:U145"><span class="mxinfo" id="T4:U146"><span class="var type1" id="S3T17U222">Maximas</span>(<span class="var type1" id="S6T1U223">nMaxima</span>,<span class="mxinfo" id="T25:U149">:</span>)</span> = (<span class="mxinfo" id="T4:U150"><span class="var type1" id="S18T4U227">y_new</span>-<span class="mxinfo" id="T1:U152">1</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43">43</a></span><span class="line">            <span class="mxinfo" id="T1:U153"><span class="mxinfo" id="T1:U154"><span class="var type1" id="S4T23U232">Mcount</span>(<span class="var type1" id="S6T1U233">nMaxima</span>)</span>=<span class="mxinfo" id="T1:U157">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44">44</a></span><span class="line">            <span class="mxinfo" id="T1:U158"><span class="mxinfo" id="T1:U159"><span class="var type1" id="S5T23U238">Mpot</span>(<span class="var type1" id="S6T1U239">nMaxima</span>)</span>=<span class="mxinfo" id="T1:U162"><span class="fcn" id="F6N2:B241">UGM_ConfigurationPotential</span>(<span class="var type1" id="S18T4U242">y_new</span>,<span class="var type1" id="S8T5U243">nodePot</span>,<span class="var type1" id="S9T6U244">edgePot</span>,<span class="var type1" id="S10T7U245">edgeEnds</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45">45</a></span><span class="line">            <span class="mxinfo" id="T1:U167"><span class="mxinfo" id="T1:U168"><span class="var type1" id="S2T4U249">Chrom_maxima</span>(<span class="var type1" id="S15T1U250">t</span>)</span>=<span class="var type1" id="S6T1U251">nMaxima</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46">46</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47">47</a></span><span class="line">            <span class="mxinfo" id="T1:U172"><span class="mxinfo" id="T1:U173"><span class="var type1" id="S4T23U256">Mcount</span>(<span class="var type1" id="S20T1U257">i</span>)</span>=<span class="mxinfo" id="T1:U176"><span class="mxinfo" id="T1:U177"><span class="var type1" id="S4T23U260">Mcount</span>(<span class="var type1" id="S20T1U261">i</span>)</span>+<span class="mxinfo" id="T1:U180">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48">48</a></span><span class="line">            <span class="mxinfo" id="T1:U181"><span class="mxinfo" id="T1:U182"><span class="var type1" id="S2T4U266">Chrom_maxima</span>(<span class="var type1" id="S15T1U267">t</span>)</span>=<span class="var type1" id="S20T1U268">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49">49</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50">50</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,51">51</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52">52</a></span><span class="line">        <span class="mxinfo" id="T1:U186"><span class="var type1" id="S6T1U272">nMaxima</span>=<span class="mxinfo" id="T1:U188"><span class="var type1" id="S6T1U274">nMaxima</span>+<span class="mxinfo" id="T1:U190">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53">53</a></span><span class="line">        <span class="mxinfo" id="T4:U191"><span class="mxinfo" id="T4:U192"><span class="var type1" id="S3T17U279">Maximas</span>(<span class="var type1" id="S6T1U280">nMaxima</span>,<span class="mxinfo" id="T25:U195">:</span>)</span> = (<span class="mxinfo" id="T4:U196"><span class="var type1" id="S18T4U284">y_new</span>-<span class="mxinfo" id="T1:U198">1</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54">54</a></span><span class="line">        <span class="mxinfo" id="T1:U199"><span class="mxinfo" id="T1:U200"><span class="var type1" id="S5T23U289">Mpot</span>(<span class="var type1" id="S6T1U290">nMaxima</span>)</span>=<span class="mxinfo" id="T1:U203"><span class="fcn" id="F6N2:B292">UGM_ConfigurationPotential</span>(<span class="var type1" id="S18T4U293">y_new</span>,<span class="var type1" id="S8T5U294">nodePot</span>,<span class="var type1" id="S9T6U295">edgePot</span>,<span class="var type1" id="S10T7U296">edgeEnds</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55">55</a></span><span class="line">        <span class="mxinfo" id="T1:U208"><span class="mxinfo" id="T1:U209"><span class="var type1" id="S2T4U300">Chrom_maxima</span>(<span class="var type1" id="S15T1U301">t</span>)</span>=<span class="mxinfo" id="T1:U212">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56">56</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57">57</a></span><span class="line">    <span class="comment">%n(t)=nMaxima;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58">58</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59">59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60">60</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
